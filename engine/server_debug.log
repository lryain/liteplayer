nohup: ignoring input
========================================
  Music Player Server
  Phase 4 - ZMQ Remote Control
========================================

[Server] Using config file: config/music_player.yaml
[ConfigLoader] Database path: data/music_library.db -> /home/pi/dev/nora-xiaozhi-dev/3rd/liteplayer/engine/build/data/music_library.db
[ConfigLoader] Configuration loaded successfully
[MusicPlayerService] ZMQ initialized
  Command endpoint: ipc:///tmp/music_player_cmd.sock
  Event endpoint: ipc:///tmp/music_player_event.sock
[MusicLibrary] Database opened: /home/pi/dev/nora-xiaozhi-dev/3rd/liteplayer/engine/build/data/music_library.db
[LitePlayerWrapper] Initialized successfully
[PlaybackController] Initialized successfully
[MusicPlayerService] Scanning music directories...
[MusicPlayerService] Scanning directory: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal
[0;34m2026-02-12 15:01:33:365 D mlooper: [ael-listplayer]: Entry looper thread: thread_id=[0x7fb3ffef40]
[0m  Found 32 tracks
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/sheep.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/pig.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/kookaburra.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/elephant.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/zebra.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/cow.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/leopard.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/dog.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps1.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/cat.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/whale.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps2.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/goose.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bird.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/coyote.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/crow.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bear.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/tiger.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/snake.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/frog.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/chimpanzee.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/rooster.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/owl.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/wolf.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/lion.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/donkey.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/chicken.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/horse.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/duck.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/dolphin.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/gibbon.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bee.wav
[MusicLibrary] Added 32/32 tracks
  Added 32 new tracks to database
[MusicPlayerService] Scanning directory: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music
  Found 12 tracks
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/exercise.mp3
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/classic.mp3
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/birthday.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/nature.mp3
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/ballad.mp3
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/salsa.wav
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/huangmeixi.mp3
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/AlanWalker-Faded.mp3
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/rock.mp3
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/trot.mp3
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/nature-60s.mp3
[MusicLibrary] Track already exists: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/funk.mp3
[MusicLibrary] Added 12/12 tracks
  Added 12 new tracks to database
[MusicPlayerService] Scan complete: 44 tracks added
[MusicPlayerService] Syncing 44 tracks from database to playlist...
  âœ“ Added: AlanWalker-Faded (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/AlanWalker-Faded.mp3)
  âœ“ Added: ballad (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/ballad.mp3)
  âœ“ Added: bear (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bear.wav)
  âœ“ Added: bee (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bee.wav)
  âœ“ Added: bird (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bird.wav)
  âœ“ Added: birthday (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/birthday.wav)
  âœ“ Added: budgie_chirps1 (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps1.wav)
  âœ“ Added: budgie_chirps2 (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps2.wav)
  âœ“ Added: cat (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/cat.wav)
  âœ“ Added: chicken (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/chicken.wav)
  âœ“ Added: chimpanzee (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/chimpanzee.wav)
  âœ“ Added: classic (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/classic.mp3)
  âœ“ Added: cow (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/cow.wav)
  âœ“ Added: coyote (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/coyote.wav)
  âœ“ Added: crow (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/crow.wav)
  âœ“ Added: dog (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/dog.wav)
  âœ“ Added: dolphin (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/dolphin.wav)
  âœ“ Added: donkey (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/donkey.wav)
  âœ“ Added: duck (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/duck.wav)
  âœ“ Added: elephant (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/elephant.wav)
  âœ“ Added: exercise (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/exercise.mp3)
  âœ“ Added: frog (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/frog.wav)
  âœ“ Added: funk (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/funk.mp3)
  âœ“ Added: gibbon (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/gibbon.wav)
  âœ“ Added: goose (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/goose.wav)
  âœ“ Added: horse (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/horse.wav)
  âœ“ Added: huangmeixi (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/huangmeixi.mp3)
  âœ“ Added: kookaburra (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/kookaburra.wav)
  âœ“ Added: leopard (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/leopard.wav)
  âœ“ Added: lion (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/lion.wav)
  âœ“ Added: nature (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/nature.mp3)
  âœ“ Added: nature-60s (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/nature-60s.mp3)
  âœ“ Added: owl (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/owl.wav)
  âœ“ Added: pig (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/pig.wav)
  âœ“ Added: rock (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/rock.mp3)
  âœ“ Added: rooster (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/rooster.wav)
  âœ“ Added: salsa (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/salsa.wav)
  âœ“ Added: sheep (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/sheep.wav)
  âœ“ Added: snake (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/snake.wav)
  âœ“ Added: tiger (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/tiger.wav)
  âœ“ Added: trot (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/trot.mp3)
  âœ“ Added: whale (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/whale.wav)
  âœ“ Added: wolf (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/wolf.wav)
  âœ“ Added: zebra (/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/zebra.wav)
[MusicPlayerService] Playlist now has 44 tracks
[MusicPlayerService] Service initialized successfully
[MusicPlayerService] Command loop started
[MusicPlayerService] Service started
[Server] Service is running. Press Ctrl+C to stop.

[MusicPlayerService] Event loop started
[MusicPlayerService] Received command: play
[MusicPlayerService] Playing track index: 2
[PlaybackController::playTrack] ========== START (index=2) ==========
[PlaybackController::playTrack] Seeking to index 2
[PlaybackController::playTrack] Starting track at index 2
[PlaybackController] startCurrentTrackInternal: "bear" (path=/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bear.wav)
[PlaybackController] Releasing state lock, acquiring player lock...
[PlaybackController] âœ… Acquired player operation lock
[PlaybackController] Calling player_.reset()...
[LitePlayerWrapper] reset called
[LitePlayerWrapper] reset result=0
[PlaybackController] Waiting for reset to complete (200ms)...
[PlaybackController] Loading file: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bear.wav
[LitePlayerWrapper] loadFile called: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bear.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_set_data_source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bear.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_prepare_async
[LitePlayerWrapper] loadPlaylist finished
[LitePlayerWrapper] loadFile result: success
[PlaybackController] Waiting for async prepare (500ms)...
[0;32m2026-02-12 15:01:43:685 I [liteplayer]core: Set player source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bear.wav
[0m[0;34m2026-02-12 15:01:43:685 D [liteplayer]core: Using source_wrapper: (file), sink_wrapper: (alsa)
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 1
[PlaybackController] State transition: 0 -> 1 (isTransitioning=0)
[0;32m2026-02-12 15:01:43:686 I [liteplayer]core: Async preparing player[file]
[0m[0;34m2026-02-12 15:01:43:686 D [liteplayer]file: Opening file:/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bear.wav, content_pos:0
[0m[0;34m2026-02-12 15:01:43:691 D [liteplayer]wav_extractor: WAV INFO:
[0m[0;34m2026-02-12 15:01:43:691 D [liteplayer]wav_extractor:   >audioFormat          : 1
[0m[0;34m2026-02-12 15:01:43:691 D [liteplayer]wav_extractor:   >sampleRate           : 48000
[0m[0;34m2026-02-12 15:01:43:691 D [liteplayer]wav_extractor:   >channels             : 1
[0m[0;34m2026-02-12 15:01:43:691 D [liteplayer]wav_extractor:   >bits                 : 16
[0m[0;34m2026-02-12 15:01:43:691 D [liteplayer]wav_extractor:   >byteRate             : 96000
[0m[0;34m2026-02-12 15:01:43:691 D [liteplayer]wav_extractor:   >blockAlign           : 2
[0m[0;34m2026-02-12 15:01:43:691 D [liteplayer]wav_extractor:   >dataSize             : 252832
[0m[0;34m2026-02-12 15:01:43:691 D [liteplayer]wav_extractor:   >dataOffset           : 44
[0m[0;32m2026-02-12 15:01:43:691 I [liteplayer]parser: MediaInfo: codec_type[1], samplerate[48000], channels[1], bits[16], pos[44], len[252876], duration[2000ms]
[0m[0;34m2026-02-12 15:01:43:691 D [liteplayer]parser: Mediasource will reuse source handle, save remaing 2004 bytes in ringbuf
[0m[0;34m2026-02-12 15:01:43:691 D [liteplayer]core: [1.0] Create decoder element
[0m[0;34m2026-02-12 15:01:43:692 D [liteplayer]core: [1.1] Create sink element
[0m[0;34m2026-02-12 15:01:43:692 D [liteplayer]core: [1.2] Create source element, sync mode, ringbuf size: 2048
[0m[0;34m2026-02-12 15:01:43:692 D [liteplayer]core: [2.0] Register event callback of decoder elements
[0m[0;34m2026-02-12 15:01:43:692 D [liteplayer]core: [3.0] Run decoder element
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 1
[PlaybackController] State transition: 1 -> 1 (isTransitioning=0)
[PlaybackController] Calling player_.start()...
[LitePlayerWrapper] start called, current state=1
[LitePlayerWrapper] start result=0
[PlaybackController] âœ… Track started successfully
[PlaybackController::playTrack] ========== END (result=1) ==========
[MusicPlayerService] â–¶ï¸  Playing: "bear"
[MusicPlayerService] Sending response for: play
[MusicPlayerService] Response sent
[0;32m2026-02-12 15:01:44:186 I [liteplayer]core: Starting player[file]
[0m[0;34m2026-02-12 15:01:44:186 D [liteplayer]audio_element: [wav_decoder] opening input reader
[0m[0;34m2026-02-12 15:01:44:186 D [liteplayer]audio_element: [wav_decoder] opening output writer
[0m[0;34m2026-02-12 15:01:44:186 D [liteplayer]audio_element: [wav_decoder] el opened
[0m[0;34m2026-02-12 15:01:44:186 D [liteplayer]core: [ file-wav_decoder ] Receive started event
[0m[0;32m2026-02-12 15:01:44:186 I [liteplayer]core: [ file-wav_decoder ] Receive codec info: samplerate=48000, ch=1, bits=16
[0m[0;34m2026-02-12 15:01:44:186 D [liteplayer]audio_element: [wav_decoder] Element resumed
[0m[0;32m2026-02-12 15:01:44:186 I [liteplayer]core: Opening sink: rate:48000, channels:1, bits:16
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 2
[PlaybackController] State transition: 1 -> 2 (isTransitioning=0)
[0;34m2026-02-12 15:01:44:186 D [liteplayer]alsa: Opening alsa: samplerate=48000, channels=1, bits=16
[0mPlug PCM: Route conversion PCM (sformat=S16_LE)
  Transformation table:
    0 <- 0
    1 <- 0
Its setup is:
  stream       : PLAYBACK
  access       : RW_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 1
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : NONE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 18000
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
Slave: Direct Stream Mixing PCM
Its setup is:
  stream       : PLAYBACK
  access       : MMAP_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 2
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : NONE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 18000
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
Hardware PCM card 0 'wm8960-soundcard' device 0 subdevice 0
Its setup is:
  stream       : PLAYBACK
  access       : MMAP_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 2
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : ENABLE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 0
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
  appl_ptr     : 0
  hw_ptr       : 959784152
[MusicPlayerService] Received command: play
[MusicPlayerService] Playing track index: 2
[PlaybackController::playTrack] ========== START (index=2) ==========
[PlaybackController::playTrack] Seeking to index 2
[PlaybackController::playTrack] Stopping current playback before switching
[PlaybackController] safeStopInternal: initiating stop from state=2
[PlaybackController] safeStopInternal: calling player_.stop() with player lock
[PlaybackController] safeStopInternal: stop called, waiting for Stopped state...
[0;32m2026-02-12 15:01:44:439 I [liteplayer]core: Stopping player[file]
[0m[0;34m2026-02-12 15:01:44:497 D [liteplayer]audio_element: [wav_decoder] closing output writer
[0m[0;32m2026-02-12 15:01:44:497 I [liteplayer]core: Closing sink
[0m[0;34m2026-02-12 15:01:44:497 D [liteplayer]alsa: closing alsa
[0m[0;34m2026-02-12 15:01:44:872 D [liteplayer]audio_element: [wav_decoder] closing input reader
[0m[0;32m2026-02-12 15:01:44:872 I [liteplayer]core: Closing source
[0m[0;34m2026-02-12 15:01:44:872 D [liteplayer]file: Closing file:0x7fac000b60
[0m[0;34m2026-02-12 15:01:44:872 D [liteplayer]audio_element: [wav_decoder] closed
[0m[0;34m2026-02-12 15:01:44:872 D [liteplayer]core: [ file-wav_decoder ] Receive stopped event
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 4
[PlaybackController] State transition: 2 -> 4 (isTransitioning=1)
[PlaybackController] safeStopInternal: reached Stopped state
[PlaybackController] safeStopInternal: calling player_.reset() with player lock
[LitePlayerWrapper] reset called
[LitePlayerWrapper] reset result=0
[0;32m2026-02-12 15:01:44:872 I [liteplayer]core: Resetting player[file]
[0m[0;34m2026-02-12 15:01:44:872 D [liteplayer]core: Destroy audio decoder
[0m[0;34m2026-02-12 15:01:44:872 D [liteplayer]core: [ file-wav_decoder ] Receive stopped event
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 0
[PlaybackController] State transition: 4 -> 0 (isTransitioning=1)
[PlaybackController] safeStopInternal: completed
[PlaybackController::playTrack] Starting track at index 2
[PlaybackController] startCurrentTrackInternal: "bear" (path=/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bear.wav)
[PlaybackController] Releasing state lock, acquiring player lock...
[PlaybackController] âœ… Acquired player operation lock
[PlaybackController] Calling player_.reset()...
[LitePlayerWrapper] reset called
[LitePlayerWrapper] reset result=0
[PlaybackController] Waiting for reset to complete (200ms)...
[PlaybackController] Loading file: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bear.wav
[LitePlayerWrapper] loadFile called: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bear.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_set_data_source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bear.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_prepare_async
[LitePlayerWrapper] loadPlaylist finished
[LitePlayerWrapper] loadFile result: success
[PlaybackController] Waiting for async prepare (500ms)...
[0;32m2026-02-12 15:01:45:123 I [liteplayer]core: Set player source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bear.wav
[0m[0;34m2026-02-12 15:01:45:123 D [liteplayer]core: Using source_wrapper: (file), sink_wrapper: (alsa)
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 1
[PlaybackController] State transition: 0 -> 1 (isTransitioning=1)
[0;32m2026-02-12 15:01:45:124 I [liteplayer]core: Async preparing player[file]
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]file: Opening file:/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bear.wav, content_pos:0
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]wav_extractor: WAV INFO:
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]wav_extractor:   >audioFormat          : 1
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]wav_extractor:   >sampleRate           : 48000
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]wav_extractor:   >channels             : 1
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]wav_extractor:   >bits                 : 16
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]wav_extractor:   >byteRate             : 96000
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]wav_extractor:   >blockAlign           : 2
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]wav_extractor:   >dataSize             : 252832
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]wav_extractor:   >dataOffset           : 44
[0m[0;32m2026-02-12 15:01:45:124 I [liteplayer]parser: MediaInfo: codec_type[1], samplerate[48000], channels[1], bits[16], pos[44], len[252876], duration[2000ms]
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]parser: Mediasource will reuse source handle, save remaing 2004 bytes in ringbuf
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]core: [1.0] Create decoder element
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]core: [1.1] Create sink element
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]core: [1.2] Create source element, sync mode, ringbuf size: 2048
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]core: [2.0] Register event callback of decoder elements
[0m[0;34m2026-02-12 15:01:45:124 D [liteplayer]core: [3.0] Run decoder element
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 1
[PlaybackController] State transition: 1 -> 1 (isTransitioning=1)
[PlaybackController] Calling player_.start()...
[LitePlayerWrapper] start called, current state=1
[LitePlayerWrapper] start result=0
[PlaybackController] âœ… Track started successfully
[PlaybackController::playTrack] ========== END (result=1) ==========
[MusicPlayerService] â–¶ï¸  Playing: "bear"
[MusicPlayerService] Sending response for: play
[MusicPlayerService] Response sent
[0;32m2026-02-12 15:01:45:624 I [liteplayer]core: Starting player[file]
[0m[0;34m2026-02-12 15:01:45:624 D [liteplayer]audio_element: [wav_decoder] opening input reader
[0m[0;34m2026-02-12 15:01:45:624 D [liteplayer]audio_element: [wav_decoder] opening output writer
[0m[0;34m2026-02-12 15:01:45:624 D [liteplayer]audio_element: [wav_decoder] el opened
[0m[0;34m2026-02-12 15:01:45:624 D [liteplayer]core: [ file-wav_decoder ] Receive started event
[0m[0;32m2026-02-12 15:01:45:624 I [liteplayer]core: [ file-wav_decoder ] Receive codec info: samplerate=48000, ch=1, bits=16
[0m[0;32m2026-02-12 15:01:45:624 I [liteplayer]core: Opening sink: rate:48000, channels:1, bits:16
[0m[0;34m2026-02-12 15:01:45:624 D [liteplayer]alsa: Opening alsa: samplerate=48000, channels=1, bits=16
[0m[0;34m2026-02-12 15:01:45:625 D [liteplayer]audio_element: [wav_decoder] Element resumed
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 2
[PlaybackController] State transition: 1 -> 2 (isTransitioning=0)
Plug PCM: Route conversion PCM (sformat=S16_LE)
  Transformation table:
    0 <- 0
    1 <- 0
Its setup is:
  stream       : PLAYBACK
  access       : RW_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 1
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : NONE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 18000
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
Slave: Direct Stream Mixing PCM
Its setup is:
  stream       : PLAYBACK
  access       : MMAP_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 2
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : NONE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 18000
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
Hardware PCM card 0 'wm8960-soundcard' device 0 subdevice 0
Its setup is:
  stream       : PLAYBACK
  access       : MMAP_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 2
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : ENABLE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 0
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
  appl_ptr     : 0
  hw_ptr       : 959856280
[0;34m2026-02-12 15:01:48:122 D [liteplayer]audio_element: [wav_decoder] closing output writer
[0m[0;32m2026-02-12 15:01:48:122 I [liteplayer]core: Closing sink
[0m[0;34m2026-02-12 15:01:48:122 D [liteplayer]alsa: closing alsa
[0m[0;34m2026-02-12 15:01:48:372 D [liteplayer]audio_element: [wav_decoder] closing input reader
[0m[0;32m2026-02-12 15:01:48:372 I [liteplayer]core: Closing source
[0m[0;34m2026-02-12 15:01:48:372 D [liteplayer]file: Closing file:0x7fac000e90
[0m[0;34m2026-02-12 15:01:48:372 D [liteplayer]audio_element: [wav_decoder] closed
[0m[0;34m2026-02-12 15:01:48:372 D [liteplayer]core: [ file-wav_decoder ] Receive finished event
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 4
[PlaybackController] State transition: 2 -> 4 (isTransitioning=0)
[PlaybackController] Track completed (auto-next requested)
[MusicPlayerService] Controller event: TrackEnded (bear)
[PlaybackController::next] ========== START ==========
[PlaybackController::next] Setting isTransitioning_=true
[PlaybackController::next] Calling safeStopInternal...
[PlaybackController] safeStopInternal: already stopped/idle
[PlaybackController::next] Moving to next track in playlist
[PlaybackController::next] Starting new track...
[PlaybackController] startCurrentTrackInternal: "bee" (path=/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bee.wav)
[PlaybackController] Releasing state lock, acquiring player lock...
[PlaybackController] âœ… Acquired player operation lock
[PlaybackController] Calling player_.reset()...
[LitePlayerWrapper] reset called
[LitePlayerWrapper] reset result=0
[PlaybackController] Waiting for reset to complete (200ms)...
[0;32m2026-02-12 15:01:48:379 I [liteplayer]core: Resetting player[file]
[0m[0;34m2026-02-12 15:01:48:379 D [liteplayer]core: Destroy audio decoder
[0m[0;34m2026-02-12 15:01:48:379 D [liteplayer]core: [ file-wav_decoder ] Receive stopped event
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 4
[PlaybackController] State transition: 4 -> 4 (isTransitioning=1)
[PlaybackController::onPlayerStateChanged] Callback thread - new state: 0
[PlaybackController] State transition: 4 -> 0 (isTransitioning=1)
[PlaybackController] Loading file: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bee.wav
[LitePlayerWrapper] loadFile called: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bee.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_set_data_source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bee.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_prepare_async
[LitePlayerWrapper] loadPlaylist finished
[LitePlayerWrapper] loadFile result: success
[PlaybackController] Waiting for async prepare (500ms)...
[0;32m2026-02-12 15:01:48:579 I [liteplayer]core: Set player source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bee.wav
[0m[0;34m2026-02-12 15:01:48:579 D [liteplayer]core: Using source_wrapper: (file), sink_wrapper: (alsa)
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 1
[PlaybackController] State transition: 0 -> 1 (isTransitioning=1)
[0;32m2026-02-12 15:01:48:579 I [liteplayer]core: Async preparing player[file]
[0m[0;34m2026-02-12 15:01:48:579 D [liteplayer]file: Opening file:/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bee.wav, content_pos:0
[0m[0;34m2026-02-12 15:01:48:587 D [liteplayer]wav_extractor: WAV INFO:
[0m[0;34m2026-02-12 15:01:48:587 D [liteplayer]wav_extractor:   >audioFormat          : 1
[0m[0;34m2026-02-12 15:01:48:587 D [liteplayer]wav_extractor:   >sampleRate           : 48000
[0m[0;34m2026-02-12 15:01:48:587 D [liteplayer]wav_extractor:   >channels             : 1
[0m[0;34m2026-02-12 15:01:48:587 D [liteplayer]wav_extractor:   >bits                 : 16
[0m[0;34m2026-02-12 15:01:48:587 D [liteplayer]wav_extractor:   >byteRate             : 96000
[0m[0;34m2026-02-12 15:01:48:587 D [liteplayer]wav_extractor:   >blockAlign           : 2
[0m[0;34m2026-02-12 15:01:48:587 D [liteplayer]wav_extractor:   >dataSize             : 417664
[0m[0;34m2026-02-12 15:01:48:587 D [liteplayer]wav_extractor:   >dataOffset           : 44
[0m[0;32m2026-02-12 15:01:48:587 I [liteplayer]parser: MediaInfo: codec_type[1], samplerate[48000], channels[1], bits[16], pos[44], len[417708], duration[4000ms]
[0m[0;34m2026-02-12 15:01:48:587 D [liteplayer]parser: Mediasource will reuse source handle, save remaing 2004 bytes in ringbuf
[0m[0;34m2026-02-12 15:01:48:587 D [liteplayer]core: [1.0] Create decoder element
[0m[0;34m2026-02-12 15:01:48:587 D [liteplayer]core: [1.1] Create sink element
[0m[0;34m2026-02-12 15:01:48:587 D [liteplayer]core: [1.2] Create source element, sync mode, ringbuf size: 2048
[0m[0;34m2026-02-12 15:01:48:587 D [liteplayer]core: [2.0] Register event callback of decoder elements
[0m[0;34m2026-02-12 15:01:48:587 D [liteplayer]core: [3.0] Run decoder element
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 1
[PlaybackController] State transition: 1 -> 1 (isTransitioning=1)
[PlaybackController] Calling player_.start()...
[LitePlayerWrapper] start called, current state=1
[LitePlayerWrapper] start result=0
[PlaybackController] âœ… Track started successfully
[PlaybackController::next] ========== END (result=1) ==========
[0;32m2026-02-12 15:01:49:080 I [liteplayer]core: Starting player[file]
[0m[0;34m2026-02-12 15:01:49:080 D [liteplayer]audio_element: [wav_decoder] opening input reader
[0m[0;34m2026-02-12 15:01:49:080 D [liteplayer]audio_element: [wav_decoder] opening output writer
[0m[0;34m2026-02-12 15:01:49:080 D [liteplayer]audio_element: [wav_decoder] el opened
[0m[0;34m2026-02-12 15:01:49:080 D [liteplayer]core: [ file-wav_decoder ] Receive started event
[0m[0;34m2026-02-12 15:01:49:080 D [liteplayer]audio_element: [wav_decoder] Element resumed
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 2
[PlaybackController] State transition: 1 -> 2 (isTransitioning=0)
[0;32m2026-02-12 15:01:49:080 I [liteplayer]core: [ file-wav_decoder ] Receive codec info: samplerate=48000, ch=1, bits=16
[0m[0;32m2026-02-12 15:01:49:080 I [liteplayer]core: Opening sink: rate:48000, channels:1, bits:16
[0m[0;34m2026-02-12 15:01:49:080 D [liteplayer]alsa: Opening alsa: samplerate=48000, channels=1, bits=16
[0mPlug PCM: Route conversion PCM (sformat=S16_LE)
  Transformation table:
    0 <- 0
    1 <- 0
Its setup is:
  stream       : PLAYBACK
  access       : RW_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 1
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : NONE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 18000
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
Slave: Direct Stream Mixing PCM
Its setup is:
  stream       : PLAYBACK
  access       : MMAP_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 2
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : NONE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 18000
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
Hardware PCM card 0 'wm8960-soundcard' device 0 subdevice 0
Its setup is:
  stream       : PLAYBACK
  access       : MMAP_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 2
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : ENABLE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 0
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
  appl_ptr     : 0
  hw_ptr       : 960018152
[0;34m2026-02-12 15:01:53:124 D [liteplayer]audio_element: [wav_decoder] closing output writer
[0m[0;32m2026-02-12 15:01:53:124 I [liteplayer]core: Closing sink
[0m[0;34m2026-02-12 15:01:53:124 D [liteplayer]alsa: closing alsa
[0m[MusicPlayerService] Received command: play
[PlaybackController::play] ========== START ==========
[PlaybackController::play] Already playing
[MusicPlayerService] â–¶ï¸  Playing: "bee"
[MusicPlayerService] Sending response for: play
[MusicPlayerService] Response sent
[0;34m2026-02-12 15:01:53:497 D [liteplayer]audio_element: [wav_decoder] closing input reader
[0m[0;32m2026-02-12 15:01:53:497 I [liteplayer]core: Closing source
[0m[0;34m2026-02-12 15:01:53:497 D [liteplayer]file: Closing file:0x7fac000e90
[0m[0;34m2026-02-12 15:01:53:497 D [liteplayer]audio_element: [wav_decoder] closed
[0m[0;34m2026-02-12 15:01:53:497 D [liteplayer]core: [ file-wav_decoder ] Receive finished event
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 4
[PlaybackController] State transition: 2 -> 4 (isTransitioning=0)
[PlaybackController] Track completed (auto-next requested)
[MusicPlayerService] Controller event: TrackEnded (bee)
[PlaybackController::next] ========== START ==========
[PlaybackController::next] Setting isTransitioning_=true
[PlaybackController::next] Calling safeStopInternal...
[PlaybackController] safeStopInternal: already stopped/idle
[PlaybackController::next] Moving to next track in playlist
[PlaybackController::next] Starting new track...
[PlaybackController] startCurrentTrackInternal: "bird" (path=/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bird.wav)
[PlaybackController] Releasing state lock, acquiring player lock...
[PlaybackController] âœ… Acquired player operation lock
[PlaybackController] Calling player_.reset()...
[LitePlayerWrapper] reset called
[LitePlayerWrapper] reset result=0
[PlaybackController] Waiting for reset to complete (200ms)...
[0;32m2026-02-12 15:01:53:500 I [liteplayer]core: Resetting player[file]
[0m[0;34m2026-02-12 15:01:53:500 D [liteplayer]core: Destroy audio decoder
[0m[0;34m2026-02-12 15:01:53:500 D [liteplayer]core: [ file-wav_decoder ] Receive stopped event
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 4
[PlaybackController] State transition: 4 -> 4 (isTransitioning=1)
[PlaybackController::onPlayerStateChanged] Callback thread - new state: 0
[PlaybackController] State transition: 4 -> 0 (isTransitioning=1)
[PlaybackController] Loading file: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bird.wav
[LitePlayerWrapper] loadFile called: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bird.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_set_data_source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bird.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_prepare_async
[LitePlayerWrapper] loadPlaylist finished
[LitePlayerWrapper] loadFile result: success
[PlaybackController] Waiting for async prepare (500ms)...
[0;32m2026-02-12 15:01:53:700 I [liteplayer]core: Set player source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bird.wav
[0m[0;34m2026-02-12 15:01:53:700 D [liteplayer]core: Using source_wrapper: (file), sink_wrapper: (alsa)
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 1
[PlaybackController] State transition: 0 -> 1 (isTransitioning=1)
[0;32m2026-02-12 15:01:53:700 I [liteplayer]core: Async preparing player[file]
[0m[0;34m2026-02-12 15:01:53:700 D [liteplayer]file: Opening file:/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bird.wav, content_pos:0
[0m[0;34m2026-02-12 15:01:53:709 D [liteplayer]wav_extractor: WAV INFO:
[0m[0;34m2026-02-12 15:01:53:709 D [liteplayer]wav_extractor:   >audioFormat          : 1
[0m[0;34m2026-02-12 15:01:53:709 D [liteplayer]wav_extractor:   >sampleRate           : 48000
[0m[0;34m2026-02-12 15:01:53:709 D [liteplayer]wav_extractor:   >channels             : 1
[0m[0;34m2026-02-12 15:01:53:709 D [liteplayer]wav_extractor:   >bits                 : 16
[0m[0;34m2026-02-12 15:01:53:709 D [liteplayer]wav_extractor:   >byteRate             : 96000
[0m[0;34m2026-02-12 15:01:53:709 D [liteplayer]wav_extractor:   >blockAlign           : 2
[0m[0;34m2026-02-12 15:01:53:709 D [liteplayer]wav_extractor:   >dataSize             : 260184
[0m[0;34m2026-02-12 15:01:53:709 D [liteplayer]wav_extractor:   >dataOffset           : 44
[0m[0;32m2026-02-12 15:01:53:709 I [liteplayer]parser: MediaInfo: codec_type[1], samplerate[48000], channels[1], bits[16], pos[44], len[260228], duration[2000ms]
[0m[0;34m2026-02-12 15:01:53:709 D [liteplayer]parser: Mediasource will reuse source handle, save remaing 2004 bytes in ringbuf
[0m[0;34m2026-02-12 15:01:53:709 D [liteplayer]core: [1.0] Create decoder element
[0m[0;34m2026-02-12 15:01:53:709 D [liteplayer]core: [1.1] Create sink element
[0m[0;34m2026-02-12 15:01:53:709 D [liteplayer]core: [1.2] Create source element, sync mode, ringbuf size: 2048
[0m[0;34m2026-02-12 15:01:53:709 D [liteplayer]core: [2.0] Register event callback of decoder elements
[0m[0;34m2026-02-12 15:01:53:709 D [liteplayer]core: [3.0] Run decoder element
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 1
[PlaybackController] State transition: 1 -> 1 (isTransitioning=1)
[PlaybackController] Calling player_.start()...
[LitePlayerWrapper] start called, current state=1
[LitePlayerWrapper] start result=0
[PlaybackController] âœ… Track started successfully
[PlaybackController::next] ========== END (result=1) ==========
[0;32m2026-02-12 15:01:54:200 I [liteplayer]core: Starting player[file]
[0m[MusicPlayerService] Received command: play
[PlaybackController::play] ========== START ==========
[PlaybackController::play] Starting current track
[PlaybackController] startCurrentTrackInternal: "bird" (path=/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bird.wav)
[PlaybackController] Releasing state lock, acquiring player lock...
[PlaybackController] âœ… Acquired player operation lock
[PlaybackController] Calling player_.reset()...
[LitePlayerWrapper] reset called
[LitePlayerWrapper] reset result=0
[PlaybackController] Waiting for reset to complete (200ms)...
[0;34m2026-02-12 15:01:54:200 D [liteplayer]audio_element: [wav_decoder] opening input reader
[0m[0;34m2026-02-12 15:01:54:201 D [liteplayer]audio_element: [wav_decoder] opening output writer
[0m[0;34m2026-02-12 15:01:54:201 D [liteplayer]audio_element: [wav_decoder] el opened
[0m[0;34m2026-02-12 15:01:54:201 D [liteplayer]core: [ file-wav_decoder ] Receive started event
[0m[0;32m2026-02-12 15:01:54:201 I [liteplayer]core: [ file-wav_decoder ] Receive codec info: samplerate=48000, ch=1, bits=16
[0m[0;32m2026-02-12 15:01:54:201 I [liteplayer]core: Opening sink: rate:48000, channels:1, bits:16
[0m[0;34m2026-02-12 15:01:54:201 D [liteplayer]alsa: Opening alsa: samplerate=48000, channels=1, bits=16
[0m[0;34m2026-02-12 15:01:54:201 D [liteplayer]audio_element: [wav_decoder] Element resumed
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 2
[PlaybackController] State transition: 1 -> 2 (isTransitioning=0)
[0;32m2026-02-12 15:01:54:201 I [liteplayer]core: Resetting player[file]
[0m[0;34m2026-02-12 15:01:54:201 D [liteplayer]core: Destroy audio decoder
[0mPlug PCM: Route conversion PCM (sformat=S16_LE)
  Transformation table:
    0 <- 0
    1 <- 0
Its setup is:
  stream       : PLAYBACK
  access       : RW_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 1
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : NONE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 18000
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
Slave: Direct Stream Mixing PCM
Its setup is:
  stream       : PLAYBACK
  access       : MMAP_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 2
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : NONE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 18000
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
Hardware PCM card 0 'wm8960-soundcard' device 0 subdevice 0
Its setup is:
  stream       : PLAYBACK
  access       : MMAP_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 2
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : ENABLE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 0
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
  appl_ptr     : 0
  hw_ptr       : 960264176
[0;34m2026-02-12 15:01:54:203 D [liteplayer]audio_element: [wav_decoder] closing output writer
[0m[0;32m2026-02-12 15:01:54:203 I [liteplayer]core: Closing sink
[0m[0;34m2026-02-12 15:01:54:203 D [liteplayer]alsa: closing alsa
[0m[0;34m2026-02-12 15:01:54:247 D [liteplayer]audio_element: [wav_decoder] closing input reader
[0m[0;32m2026-02-12 15:01:54:247 I [liteplayer]core: Closing source
[0m[0;34m2026-02-12 15:01:54:247 D [liteplayer]file: Closing file:0x7fac000e90
[0m[0;34m2026-02-12 15:01:54:247 D [liteplayer]audio_element: [wav_decoder] closed
[0m[0;34m2026-02-12 15:01:54:247 D [liteplayer]core: [ file-wav_decoder ] Receive stopped event
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 4
[PlaybackController] State transition: 2 -> 4 (isTransitioning=0)
[PlaybackController] Track completed (auto-next requested)
[PlaybackController::onPlayerStateChanged] Callback thread - new state: 0
[PlaybackController] State transition: 4 -> 0 (isTransitioning=0)
[PlaybackController] Loading file: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bird.wav
[LitePlayerWrapper] loadFile called: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bird.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_set_data_source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bird.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_prepare_async
[LitePlayerWrapper] loadPlaylist finished
[LitePlayerWrapper] loadFile result: success
[PlaybackController] Waiting for async prepare (500ms)...
[0;32m2026-02-12 15:01:54:401 I [liteplayer]core: Set player source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bird.wav
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]core: Using source_wrapper: (file), sink_wrapper: (alsa)
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 1
[PlaybackController] State transition: 0 -> 1 (isTransitioning=0)
[0;32m2026-02-12 15:01:54:401 I [liteplayer]core: Async preparing player[file]
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]file: Opening file:/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/bird.wav, content_pos:0
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]wav_extractor: WAV INFO:
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]wav_extractor:   >audioFormat          : 1
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]wav_extractor:   >sampleRate           : 48000
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]wav_extractor:   >channels             : 1
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]wav_extractor:   >bits                 : 16
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]wav_extractor:   >byteRate             : 96000
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]wav_extractor:   >blockAlign           : 2
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]wav_extractor:   >dataSize             : 260184
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]wav_extractor:   >dataOffset           : 44
[0m[0;32m2026-02-12 15:01:54:401 I [liteplayer]parser: MediaInfo: codec_type[1], samplerate[48000], channels[1], bits[16], pos[44], len[260228], duration[2000ms]
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]parser: Mediasource will reuse source handle, save remaing 2004 bytes in ringbuf
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]core: [1.0] Create decoder element
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]core: [1.1] Create sink element
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]core: [1.2] Create source element, sync mode, ringbuf size: 2048
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]core: [2.0] Register event callback of decoder elements
[0m[0;34m2026-02-12 15:01:54:401 D [liteplayer]core: [3.0] Run decoder element
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 1
[PlaybackController] State transition: 1 -> 1 (isTransitioning=0)
[PlaybackController] Calling player_.start()...
[LitePlayerWrapper] start called, current state=1
[LitePlayerWrapper] start result=0
[PlaybackController] âœ… Track started successfully
[PlaybackController::play] ========== END ==========
[MusicPlayerService] â–¶ï¸  Playing: "bird"
[MusicPlayerService] Sending response for: play
[MusicPlayerService] Response sent
[MusicPlayerService] Controller event: TrackEnded (bird)
[PlaybackController::next] ========== START ==========
[PlaybackController::next] Setting isTransitioning_=true
[PlaybackController::next] Calling safeStopInternal...
[PlaybackController] safeStopInternal: initiating stop from state=1
[PlaybackController] safeStopInternal: calling player_.stop() with player lock
[PlaybackController] safeStopInternal: stop called, waiting for Stopped state...
[0;32m2026-02-12 15:01:54:901 I [liteplayer]core: Starting player[file]
[0m[0;34m2026-02-12 15:01:54:901 D [liteplayer]audio_element: [wav_decoder] opening input reader
[0m[0;34m2026-02-12 15:01:54:901 D [liteplayer]audio_element: [wav_decoder] opening output writer
[0m[0;34m2026-02-12 15:01:54:901 D [liteplayer]audio_element: [wav_decoder] el opened
[0m[0;34m2026-02-12 15:01:54:901 D [liteplayer]core: [ file-wav_decoder ] Receive started event
[0m[0;34m2026-02-12 15:01:54:901 D [liteplayer]audio_element: [wav_decoder] Element resumed
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 2
[PlaybackController] State transition: 1 -> 2 (isTransitioning=1)
[0;32m2026-02-12 15:01:54:902 I [liteplayer]core: Stopping player[file]
[0m[0;32m2026-02-12 15:01:54:902 I [liteplayer]core: [ file-wav_decoder ] Receive codec info: samplerate=48000, ch=1, bits=16
[0m[0;32m2026-02-12 15:01:54:902 I [liteplayer]core: Opening sink: rate:48000, channels:1, bits:16
[0m[0;34m2026-02-12 15:01:54:902 D [liteplayer]alsa: Opening alsa: samplerate=48000, channels=1, bits=16
[0mPlug PCM: Route conversion PCM (sformat=S16_LE)
  Transformation table:
    0 <- 0
    1 <- 0
Its setup is:
  stream       : PLAYBACK
  access       : RW_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 1
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : NONE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 18000
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
Slave: Direct Stream Mixing PCM
Its setup is:
  stream       : PLAYBACK
  access       : MMAP_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 2
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : NONE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 18000
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
Hardware PCM card 0 'wm8960-soundcard' device 0 subdevice 0
Its setup is:
  stream       : PLAYBACK
  access       : MMAP_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 2
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : ENABLE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 0
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
  appl_ptr     : 0
  hw_ptr       : 960300152
[0;34m2026-02-12 15:01:54:904 D [liteplayer]audio_element: [wav_decoder] closing output writer
[0m[0;32m2026-02-12 15:01:54:904 I [liteplayer]core: Closing sink
[0m[0;34m2026-02-12 15:01:54:904 D [liteplayer]alsa: closing alsa
[0m[0;34m2026-02-12 15:01:54:997 D [liteplayer]audio_element: [wav_decoder] closing input reader
[0m[0;32m2026-02-12 15:01:54:997 I [liteplayer]core: Closing source
[0m[0;34m2026-02-12 15:01:54:997 D [liteplayer]file: Closing file:0x7fac000e90
[0m[0;34m2026-02-12 15:01:54:997 D [liteplayer]audio_element: [wav_decoder] closed
[0m[0;34m2026-02-12 15:01:54:997 D [liteplayer]core: [ file-wav_decoder ] Receive stopped event
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 4
[PlaybackController] State transition: 2 -> 4 (isTransitioning=1)
[PlaybackController] safeStopInternal: reached Stopped state
[PlaybackController] safeStopInternal: calling player_.reset() with player lock
[LitePlayerWrapper] reset called
[LitePlayerWrapper] reset result=0
[0;32m2026-02-12 15:01:54:997 I [liteplayer]core: Resetting player[file]
[0m[0;34m2026-02-12 15:01:54:997 D [liteplayer]core: Destroy audio decoder
[0m[0;34m2026-02-12 15:01:54:997 D [liteplayer]core: [ file-wav_decoder ] Receive stopped event
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 0
[PlaybackController] State transition: 4 -> 0 (isTransitioning=1)
[PlaybackController] safeStopInternal: completed
[PlaybackController::next] Moving to next track in playlist
[PlaybackController::next] Starting new track...
[PlaybackController] startCurrentTrackInternal: "birthday" (path=/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/birthday.wav)
[PlaybackController] Releasing state lock, acquiring player lock...
[PlaybackController] âœ… Acquired player operation lock
[PlaybackController] Calling player_.reset()...
[LitePlayerWrapper] reset called
[LitePlayerWrapper] reset result=0
[PlaybackController] Waiting for reset to complete (200ms)...
[PlaybackController] Loading file: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/birthday.wav
[LitePlayerWrapper] loadFile called: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/birthday.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_set_data_source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/birthday.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_prepare_async
[LitePlayerWrapper] loadPlaylist finished
[LitePlayerWrapper] loadFile result: success
[PlaybackController] Waiting for async prepare (500ms)...
[0;32m2026-02-12 15:01:55:248 I [liteplayer]core: Set player source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/birthday.wav
[0m[0;34m2026-02-12 15:01:55:248 D [liteplayer]core: Using source_wrapper: (file), sink_wrapper: (alsa)
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 1
[PlaybackController] State transition: 0 -> 1 (isTransitioning=1)
[0;32m2026-02-12 15:01:55:248 I [liteplayer]core: Async preparing player[file]
[0m[0;34m2026-02-12 15:01:55:248 D [liteplayer]file: Opening file:/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/birthday.wav, content_pos:0
[0m[0;34m2026-02-12 15:01:55:256 D [liteplayer]wav_extractor: WAV INFO:
[0m[0;34m2026-02-12 15:01:55:256 D [liteplayer]wav_extractor:   >audioFormat          : 1
[0m[0;34m2026-02-12 15:01:55:256 D [liteplayer]wav_extractor:   >sampleRate           : 48000
[0m[0;34m2026-02-12 15:01:55:256 D [liteplayer]wav_extractor:   >channels             : 1
[0m[0;34m2026-02-12 15:01:55:256 D [liteplayer]wav_extractor:   >bits                 : 16
[0m[0;34m2026-02-12 15:01:55:256 D [liteplayer]wav_extractor:   >byteRate             : 96000
[0m[0;34m2026-02-12 15:01:55:256 D [liteplayer]wav_extractor:   >blockAlign           : 2
[0m[0;34m2026-02-12 15:01:55:256 D [liteplayer]wav_extractor:   >dataSize             : 1153652
[0m[0;34m2026-02-12 15:01:55:256 D [liteplayer]wav_extractor:   >dataOffset           : 44
[0m[0;32m2026-02-12 15:01:55:256 I [liteplayer]parser: MediaInfo: codec_type[1], samplerate[48000], channels[1], bits[16], pos[44], len[1153696], duration[12000ms]
[0m[0;34m2026-02-12 15:01:55:256 D [liteplayer]parser: Mediasource will reuse source handle, save remaing 2004 bytes in ringbuf
[0m[0;34m2026-02-12 15:01:55:256 D [liteplayer]core: [1.0] Create decoder element
[0m[0;34m2026-02-12 15:01:55:256 D [liteplayer]core: [1.1] Create sink element
[0m[0;34m2026-02-12 15:01:55:256 D [liteplayer]core: [1.2] Create source element, sync mode, ringbuf size: 2048
[0m[0;34m2026-02-12 15:01:55:257 D [liteplayer]core: [2.0] Register event callback of decoder elements
[0m[0;34m2026-02-12 15:01:55:257 D [liteplayer]core: [3.0] Run decoder element
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 1
[PlaybackController] State transition: 1 -> 1 (isTransitioning=1)
[PlaybackController] Calling player_.start()...
[LitePlayerWrapper] start called, current state=1
[LitePlayerWrapper] start result=0
[PlaybackController] âœ… Track started successfully
[PlaybackController::next] ========== END (result=1) ==========
[MusicPlayerService] Received command: play
[PlaybackController::play] ========== START ==========
[PlaybackController::play] Starting current track
[PlaybackController] startCurrentTrackInternal: "birthday" (path=/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/birthday.wav)
[PlaybackController] Releasing state lock, acquiring player lock...
[PlaybackController] âœ… Acquired player operation lock
[PlaybackController] Calling player_.reset()...
[LitePlayerWrapper] reset called
[LitePlayerWrapper] reset result=0
[PlaybackController] Waiting for reset to complete (200ms)...
[0;32m2026-02-12 15:01:55:748 I [liteplayer]core: Starting player[file]
[0m[0;34m2026-02-12 15:01:55:748 D [liteplayer]audio_element: [wav_decoder] opening input reader
[0m[0;34m2026-02-12 15:01:55:748 D [liteplayer]audio_element: [wav_decoder] opening output writer
[0m[0;34m2026-02-12 15:01:55:748 D [liteplayer]audio_element: [wav_decoder] el opened
[0m[0;34m2026-02-12 15:01:55:748 D [liteplayer]core: [ file-wav_decoder ] Receive started event
[0m[0;34m2026-02-12 15:01:55:748 D [liteplayer]audio_element: [wav_decoder] Element resumed
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 2
[PlaybackController] State transition: 1 -> 2 (isTransitioning=0)
[0;32m2026-02-12 15:01:55:748 I [liteplayer]core: Resetting player[file]
[0m[0;34m2026-02-12 15:01:55:748 D [liteplayer]core: Destroy audio decoder
[0m[0;32m2026-02-12 15:01:55:748 I [liteplayer]core: [ file-wav_decoder ] Receive codec info: samplerate=48000, ch=1, bits=16
[0m[0;32m2026-02-12 15:01:55:748 I [liteplayer]core: Opening sink: rate:48000, channels:1, bits:16
[0m[0;34m2026-02-12 15:01:55:748 D [liteplayer]alsa: Opening alsa: samplerate=48000, channels=1, bits=16
[0mPlug PCM: Route conversion PCM (sformat=S16_LE)
  Transformation table:
    0 <- 0
    1 <- 0
Its setup is:
  stream       : PLAYBACK
  access       : RW_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 1
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : NONE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 18000
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
Slave: Direct Stream Mixing PCM
Its setup is:
  stream       : PLAYBACK
  access       : MMAP_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 2
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : NONE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 18000
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
Hardware PCM card 0 'wm8960-soundcard' device 0 subdevice 0
Its setup is:
  stream       : PLAYBACK
  access       : MMAP_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 2
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : ENABLE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 0
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
  appl_ptr     : 0
  hw_ptr       : 960342176
[0;34m2026-02-12 15:01:55:750 D [liteplayer]audio_element: [wav_decoder] closing output writer
[0m[0;32m2026-02-12 15:01:55:750 I [liteplayer]core: Closing sink
[0m[0;34m2026-02-12 15:01:55:750 D [liteplayer]alsa: closing alsa
[0m[0;34m2026-02-12 15:01:55:872 D [liteplayer]audio_element: [wav_decoder] closing input reader
[0m[0;32m2026-02-12 15:01:55:872 I [liteplayer]core: Closing source
[0m[0;34m2026-02-12 15:01:55:872 D [liteplayer]file: Closing file:0x7fac000e90
[0m[0;34m2026-02-12 15:01:55:872 D [liteplayer]audio_element: [wav_decoder] closed
[0m[0;34m2026-02-12 15:01:55:872 D [liteplayer]core: [ file-wav_decoder ] Receive stopped event
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 4
[PlaybackController] State transition: 2 -> 4 (isTransitioning=0)
[PlaybackController] Track completed (auto-next requested)
[PlaybackController::onPlayerStateChanged] Callback thread - new state: 0
[PlaybackController] State transition: 4 -> 0 (isTransitioning=0)
[PlaybackController] Loading file: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/birthday.wav
[LitePlayerWrapper] loadFile called: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/birthday.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_set_data_source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/birthday.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_prepare_async
[LitePlayerWrapper] loadPlaylist finished
[LitePlayerWrapper] loadFile result: success
[PlaybackController] Waiting for async prepare (500ms)...
[0;32m2026-02-12 15:01:55:948 I [liteplayer]core: Set player source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/birthday.wav
[0m[0;34m2026-02-12 15:01:55:948 D [liteplayer]core: Using source_wrapper: (file), sink_wrapper: (alsa)
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 1
[PlaybackController] State transition: 0 -> 1 (isTransitioning=0)
[0;32m2026-02-12 15:01:55:948 I [liteplayer]core: Async preparing player[file]
[0m[0;34m2026-02-12 15:01:55:948 D [liteplayer]file: Opening file:/home/pi/dev/nora-xiaozhi-dev/assets/sounds/music/birthday.wav, content_pos:0
[0m[0;34m2026-02-12 15:01:55:949 D [liteplayer]wav_extractor: WAV INFO:
[0m[0;34m2026-02-12 15:01:55:949 D [liteplayer]wav_extractor:   >audioFormat          : 1
[0m[0;34m2026-02-12 15:01:55:949 D [liteplayer]wav_extractor:   >sampleRate           : 48000
[0m[0;34m2026-02-12 15:01:55:949 D [liteplayer]wav_extractor:   >channels             : 1
[0m[0;34m2026-02-12 15:01:55:949 D [liteplayer]wav_extractor:   >bits                 : 16
[0m[0;34m2026-02-12 15:01:55:949 D [liteplayer]wav_extractor:   >byteRate             : 96000
[0m[0;34m2026-02-12 15:01:55:949 D [liteplayer]wav_extractor:   >blockAlign           : 2
[0m[0;34m2026-02-12 15:01:55:949 D [liteplayer]wav_extractor:   >dataSize             : 1153652
[0m[0;34m2026-02-12 15:01:55:949 D [liteplayer]wav_extractor:   >dataOffset           : 44
[0m[0;32m2026-02-12 15:01:55:949 I [liteplayer]parser: MediaInfo: codec_type[1], samplerate[48000], channels[1], bits[16], pos[44], len[1153696], duration[12000ms]
[0m[0;34m2026-02-12 15:01:55:949 D [liteplayer]parser: Mediasource will reuse source handle, save remaing 2004 bytes in ringbuf
[0m[0;34m2026-02-12 15:01:55:949 D [liteplayer]core: [1.0] Create decoder element
[0m[0;34m2026-02-12 15:01:55:949 D [liteplayer]core: [1.1] Create sink element
[0m[0;34m2026-02-12 15:01:55:949 D [liteplayer]core: [1.2] Create source element, sync mode, ringbuf size: 2048
[0m[0;34m2026-02-12 15:01:55:949 D [liteplayer]core: [2.0] Register event callback of decoder elements
[0m[0;34m2026-02-12 15:01:55:949 D [liteplayer]core: [3.0] Run decoder element
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 1
[PlaybackController] State transition: 1 -> 1 (isTransitioning=0)
[PlaybackController] Calling player_.start()...
[LitePlayerWrapper] start called, current state=1
[LitePlayerWrapper] start result=0
[PlaybackController] âœ… Track started successfully
[PlaybackController::play] ========== END ==========
[MusicPlayerService] â–¶ï¸  Playing: "birthday"
[MusicPlayerService] Sending response for: play
[MusicPlayerService] Response sent
[MusicPlayerService] Controller event: TrackEnded (birthday)
[PlaybackController::next] ========== START ==========
[PlaybackController::next] Setting isTransitioning_=true
[PlaybackController::next] Calling safeStopInternal...
[PlaybackController] safeStopInternal: initiating stop from state=1
[PlaybackController] safeStopInternal: calling player_.stop() with player lock
[PlaybackController] safeStopInternal: stop called, waiting for Stopped state...
[0;32m2026-02-12 15:01:56:449 I [liteplayer]core: Starting player[file]
[0m[0;34m2026-02-12 15:01:56:449 D [liteplayer]audio_element: [wav_decoder] opening input reader
[0m[0;34m2026-02-12 15:01:56:449 D [liteplayer]audio_element: [wav_decoder] opening output writer
[0m[0;34m2026-02-12 15:01:56:449 D [liteplayer]audio_element: [wav_decoder] el opened
[0m[0;34m2026-02-12 15:01:56:449 D [liteplayer]core: [ file-wav_decoder ] Receive started event
[0m[0;34m2026-02-12 15:01:56:449 D [liteplayer]audio_element: [wav_decoder] Element resumed
[0m[0;32m2026-02-12 15:01:56:449 I [liteplayer]core: [ file-wav_decoder ] Receive codec info: samplerate=48000, ch=1, bits=16
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 2
[PlaybackController] State transition: 1 -> 2 (isTransitioning=1)
[0;32m2026-02-12 15:01:56:449 I [liteplayer]core: Opening sink: rate:48000, channels:1, bits:16
[0m[0;34m2026-02-12 15:01:56:449 D [liteplayer]alsa: Opening alsa: samplerate=48000, channels=1, bits=16
[0m[0;32m2026-02-12 15:01:56:449 I [liteplayer]core: Stopping player[file]
[0mPlug PCM: Route conversion PCM (sformat=S16_LE)
  Transformation table:
    0 <- 0
    1 <- 0
Its setup is:
  stream       : PLAYBACK
  access       : RW_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 1
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : NONE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 18000
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
Slave: Direct Stream Mixing PCM
Its setup is:
  stream       : PLAYBACK
  access       : MMAP_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 2
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : NONE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 18000
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
Hardware PCM card 0 'wm8960-soundcard' device 0 subdevice 0
Its setup is:
  stream       : PLAYBACK
  access       : MMAP_INTERLEAVED
  format       : S16_LE
  subformat    : STD
  channels     : 2
  rate         : 48000
  exact rate   : 48000 (48000/1)
  msbits       : 16
  buffer_size  : 18000
  period_size  : 6000
  period_time  : 125000
  tstamp_mode  : ENABLE
  tstamp_type  : MONOTONIC
  period_step  : 1
  avail_min    : 6000
  period_event : 0
  start_threshold  : 1
  stop_threshold   : 0
  silence_threshold: 0
  silence_size : 0
  boundary     : 5066549580791808000
  appl_ptr     : 0
  hw_ptr       : 960372152
[0;34m2026-02-12 15:01:56:451 D [liteplayer]audio_element: [wav_decoder] closing output writer
[0m[0;32m2026-02-12 15:01:56:451 I [liteplayer]core: Closing sink
[0m[0;34m2026-02-12 15:01:56:451 D [liteplayer]alsa: closing alsa
[0m[0;34m2026-02-12 15:01:56:496 D [liteplayer]audio_element: [wav_decoder] closing input reader
[0m[0;32m2026-02-12 15:01:56:497 I [liteplayer]core: Closing source
[0m[0;34m2026-02-12 15:01:56:497 D [liteplayer]file: Closing file:0x7fac000e90
[0m[0;34m2026-02-12 15:01:56:497 D [liteplayer]audio_element: [wav_decoder] closed
[0m[0;34m2026-02-12 15:01:56:497 D [liteplayer]core: [ file-wav_decoder ] Receive stopped event
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 4
[PlaybackController] State transition: 2 -> 4 (isTransitioning=1)
[PlaybackController] safeStopInternal: reached Stopped state
[PlaybackController] safeStopInternal: calling player_.reset() with player lock
[LitePlayerWrapper] reset called
[LitePlayerWrapper] reset result=0
[0;32m2026-02-12 15:01:56:497 I [liteplayer]core: Resetting player[file]
[0m[0;34m2026-02-12 15:01:56:497 D [liteplayer]core: Destroy audio decoder
[0m[0;34m2026-02-12 15:01:56:497 D [liteplayer]core: [ file-wav_decoder ] Receive stopped event
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 0
[PlaybackController] State transition: 4 -> 0 (isTransitioning=1)
[PlaybackController] safeStopInternal: completed
[PlaybackController::next] Moving to next track in playlist
[PlaybackController::next] Starting new track...
[PlaybackController] startCurrentTrackInternal: "budgie_chirps1" (path=/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps1.wav)
[PlaybackController] Releasing state lock, acquiring player lock...
[PlaybackController] âœ… Acquired player operation lock
[PlaybackController] Calling player_.reset()...
[LitePlayerWrapper] reset called
[LitePlayerWrapper] reset result=0
[PlaybackController] Waiting for reset to complete (200ms)...
[PlaybackController] Loading file: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps1.wav
[LitePlayerWrapper] loadFile called: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps1.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_set_data_source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps1.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_prepare_async
[LitePlayerWrapper] loadPlaylist finished
[LitePlayerWrapper] loadFile result: success
[PlaybackController] Waiting for async prepare (500ms)...
[0;32m2026-02-12 15:01:56:747 I [liteplayer]core: Set player source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps1.wav
[0m[0;34m2026-02-12 15:01:56:747 D [liteplayer]core: Using source_wrapper: (file), sink_wrapper: (alsa)
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 1
[PlaybackController] State transition: 0 -> 1 (isTransitioning=1)
[0;32m2026-02-12 15:01:56:747 I [liteplayer]core: Async preparing player[file]
[0m[0;34m2026-02-12 15:01:56:747 D [liteplayer]file: Opening file:/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps1.wav, content_pos:0
[0m[0;34m2026-02-12 15:01:56:754 D [liteplayer]wav_extractor: WAV INFO:
[0m[0;34m2026-02-12 15:01:56:754 D [liteplayer]wav_extractor:   >audioFormat          : 1
[0m[0;34m2026-02-12 15:01:56:754 D [liteplayer]wav_extractor:   >sampleRate           : 48000
[0m[0;34m2026-02-12 15:01:56:754 D [liteplayer]wav_extractor:   >channels             : 2
[0m[0;34m2026-02-12 15:01:56:754 D [liteplayer]wav_extractor:   >bits                 : 24
[0m[0;34m2026-02-12 15:01:56:754 D [liteplayer]wav_extractor:   >byteRate             : 288000
[0m[0;34m2026-02-12 15:01:56:754 D [liteplayer]wav_extractor:   >blockAlign           : 6
[0m[0;34m2026-02-12 15:01:56:754 D [liteplayer]wav_extractor:   >dataSize             : 0
[0m[0;34m2026-02-12 15:01:56:754 D [liteplayer]wav_extractor:   >dataOffset           : 0
[0m[0;31m2026-02-12 15:01:56:754 E [liteplayer]wav_extractor: Invalid dataOffset:0
[0m[0;31m2026-02-12 15:01:56:754 E [liteplayer]wav_extractor: Failed to parse wav header
[0m[0;31m2026-02-12 15:01:56:754 E [liteplayer]parser: Failed to parse url:[/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps1.wav]
[0m[0;34m2026-02-12 15:01:56:754 D [liteplayer]file: Closing file:0x7fac000e90
[0m[0;33m2026-02-12 15:01:56:754 W [liteplayer]listplayer: Failed to play url: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps1.wav, remove this url from list
[0m[PlaybackController::onPlayerStateChanged] Callback thread - new state: 5
[PlaybackController] State transition: 1 -> 5 (isTransitioning=1)
[PlaybackController] Error: Playback error occurred
[PlaybackController] Trying next track (retry 1/3)
[PlaybackController::next] ========== START ==========
[PlaybackController::next] Setting isTransitioning_=true
[PlaybackController::next] Calling safeStopInternal...
[PlaybackController] safeStopInternal: initiating stop from state=5
[PlaybackController] Calling player_.start()...
[LitePlayerWrapper] start called, current state=5
[LitePlayerWrapper] start result=0
[PlaybackController] âœ… Track started successfully
[PlaybackController::next] ========== END (result=1) ==========
[MusicPlayerService] Received command: play
[PlaybackController::play] ========== START ==========
[PlaybackController::play] Starting current track
[PlaybackController] startCurrentTrackInternal: "budgie_chirps1" (path=/home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps1.wav)
[PlaybackController] Releasing state lock, acquiring player lock...
[PlaybackController] âœ… Acquired player operation lock
[PlaybackController] Calling player_.reset()...
[LitePlayerWrapper] reset called
[LitePlayerWrapper] reset result=0
[PlaybackController] Waiting for reset to complete (200ms)...
[PlaybackController] Loading file: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps1.wav
[LitePlayerWrapper] loadFile called: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps1.wav
[LitePlayerWrapper] loadPlaylist calling listplayer_set_data_source: /home/pi/dev/nora-xiaozhi-dev/assets/sounds/animal/budgie_chirps1.wav
